<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"lorrine-d.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.21.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Validation for Bayesian modelä¸€ä¸ªéå¸¸ä¸å®Œå–„çš„æ€»ç»“&#x2F;è®°å½• for my painful discovery of Bayesian model validationå¯èƒ½è¿˜æœ‰åç»­  Validation for Bayesian model Definition of validation Splitting dataset Posterior predictive sa">
<meta property="og:type" content="article">
<meta property="og:title" content="validation">
<meta property="og:url" content="https://lorrine-d.github.io/2025/08/18/validation/index.html">
<meta property="og:site_name" content="ğŸµ">
<meta property="og:description" content="Validation for Bayesian modelä¸€ä¸ªéå¸¸ä¸å®Œå–„çš„æ€»ç»“&#x2F;è®°å½• for my painful discovery of Bayesian model validationå¯èƒ½è¿˜æœ‰åç»­  Validation for Bayesian model Definition of validation Splitting dataset Posterior predictive sa">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-08-18T02:36:48.000Z">
<meta property="article:modified_time" content="2025-08-25T02:05:56.743Z">
<meta property="article:author" content="Nobody">
<meta property="article:tag" content="Bayesian model, method">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://lorrine-d.github.io/2025/08/18/validation/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://lorrine-d.github.io/2025/08/18/validation/","path":"2025/08/18/validation/","title":"validation"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>validation | ğŸµ</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">ğŸµ</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">What are you looking for ğŸŒ±</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Validation-for-Bayesian-model"><span class="nav-number">1.</span> <span class="nav-text">Validation for Bayesian model</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Definition-of-validation"><span class="nav-number">1.1.</span> <span class="nav-text">Definition of validation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Splitting-dataset"><span class="nav-number">1.2.</span> <span class="nav-text">Splitting dataset</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Posterior-predictive-sample"><span class="nav-number">1.3.</span> <span class="nav-text">Posterior predictive sample</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Brief-eg"><span class="nav-number">1.3.1.</span> <span class="nav-text">Brief eg.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Posterior-predict"><span class="nav-number">1.3.2.</span> <span class="nav-text">Posterior predict</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Summary"><span class="nav-number">1.3.3.</span> <span class="nav-text">Summary</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Validation"><span class="nav-number">1.4.</span> <span class="nav-text">Validation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Error"><span class="nav-number">1.4.1.</span> <span class="nav-text">Error</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Coverage"><span class="nav-number">1.4.2.</span> <span class="nav-text">Coverage</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#End"><span class="nav-number">1.5.</span> <span class="nav-text">End</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">1.6.</span> <span class="nav-text">Reference</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Nobody</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">9</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lorrine-d.github.io/2025/08/18/validation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Nobody">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ğŸµ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="validation | ğŸµ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          validation
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-08-18 10:36:48" itemprop="dateCreated datePublished" datetime="2025-08-18T10:36:48+08:00">2025-08-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-08-25 10:05:56" itemprop="dateModified" datetime="2025-08-25T10:05:56+08:00">2025-08-25</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="Validation-for-Bayesian-model"><a href="#Validation-for-Bayesian-model" class="headerlink" title="Validation for Bayesian model"></a>Validation for Bayesian model</h1><p><del><em>ä¸€ä¸ªéå¸¸ä¸å®Œå–„çš„æ€»ç»“/è®°å½• for my painful discovery of Bayesian model validation</em></del><br><em>å¯èƒ½è¿˜æœ‰åç»­</em></p>
<ul>
<li><a href="#validation-for-bayesian-model">Validation for Bayesian model</a><ul>
<li><a href="#definition-of-validation">Definition of validation</a></li>
<li><a href="#splitting-dataset">Splitting dataset</a></li>
<li><a href="#posterior-predictive-sample">Posterior predictive sample</a><ul>
<li><a href="#brief-eg">Brief eg.</a></li>
<li><a href="#posterior-predict">Posterior predict</a></li>
<li><a href="#summary">Summary</a></li>
</ul>
</li>
<li><a href="#validation">Validation</a><ul>
<li><a href="#error">Error</a></li>
<li><a href="#coverage">Coverage</a></li>
</ul>
</li>
<li><a href="#end">End</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</li>
</ul>
<p>è¯´å®è¯ï¼Œmodel validationçš„æ€»ä½“æ€è·¯å°±æ˜¯split dataset into training and testing data. ç„¶ååˆ©ç”¨training dataåœ¨testing dataçš„predictionå»åˆ¤æ–­ã€‚æœ‰äº†è¿™ä¸ªæ•´ä½“æ€è·¯ï¼Œå°±æ˜¯çœ‹éœ€è¦è§£å†³çš„é—®é¢˜ï¼š</p>
<ul>
<li>æ€ä¹ˆåˆ’åˆ†datasetï¼štraining/testing dataçš„å®šä¹‰ï¼›åœ¨ä¸åŒç ”ç©¶ä¸­ç»“åˆå®é™…ã€‚</li>
<li>å¦‚ä½•åštraining dataåœ¨testing dataçš„predictionï¼šåéªŒé¢„æµ‹è¿™ä¸€å—ï¼ˆå¯èƒ½æ˜¯è¯¥ç¯‡çš„é‡ç‚¹å†…å®¹ï¼‰</li>
<li>å¾—åˆ°predictionä¹‹åæ€ä¹ˆåˆ¤æ–­å’Œtesting dataçš„observationï¼šå¸¸ç”¨çš„validationåˆ¤æ–­ï¼Œmedian/mean/95% predicted intervalç­‰</li>
<li>å¦‚æœæ²¡æœ‰è¾¾åˆ°é¢„æœŸæ€ä¹ˆè°ƒæ•´ï¼ˆ<del>ç›®å‰æˆ‘ä¹Ÿä¸çŸ¥é“</del>ï¼ˆç¬‘ï¼‰ï¼‰ <em>æš‚æ—¶ä¸æ¶‰åŠ</em></li>
</ul>
<h2 id="Definition-of-validation"><a href="#Definition-of-validation" class="headerlink" title="Definition of validation"></a>Definition of validation</h2><p>è™½ç„¶è¯´åˆ°validationè‚¯å®šéƒ½çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯è¿˜æ˜¯åœ¨è¿™é‡Œè´´ä¸€ä¸‹ï¼ˆä¸ä¸€å®šï¼‰å®˜æ–¹çš„ï¼š</p>
<p><strong>Validation</strong> is the process of assessing how well a model performs on held-out data.</p>
<p>Why <strong>need</strong> validation? measure its predictive accuracy, for its own sake or for purposes of model comparison, selection, or averaging ï¼ˆ<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1507.04544">Vehtari et al. 2017</a>ï¼‰.</p>
<h2 id="Splitting-dataset"><a href="#Splitting-dataset" class="headerlink" title="Splitting dataset"></a>Splitting dataset</h2><p>é¦–å…ˆï¼Œå…³äºtraining/testing dataçš„å®šä¹‰å…ˆå¥‰ä¸Šï¼š</p>
<ul>
<li>Training data: Data used to fit the model</li>
<li>Testing data: Data left-out during model fitting, used to evaluate model performance</li>
</ul>
<p>éå¸¸çš„ç®€å•æ˜äº†ï¼Œä½†æ˜¯ï¼Œç»“åˆå®é™…çš„æ—¶å€™å°±è¦åˆ†æƒ…å†µäº†ã€‚ä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œéƒ½æ˜¯80% training, 20% testing.<br>(è¿™é‡Œæ˜¯ç”¨å‰80%ä½œä¸ºtraining, å20%ä½œä¸ºtesting.) ä½†æ˜¯ï¼æœ‰æ—¶å€™åˆ’åˆ†ä¸èƒ½å¾ˆç²¾ç¡®çš„æŒ‰ç…§è¿™ä¸ªæ¯”ä¾‹ï¼Œè‡³äºå¦‚ä½•åˆ’åˆ†ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå€¼å¾—ç ”ç©¶çš„é—®é¢˜ï¼Œä½†è¿™é‡Œå°±ä¸å±•å¼€ç ”ç©¶äº† <del>ï¼ˆå› ä¸ºæˆ‘ä¸ä¼šå‘¢è¿˜ã€‚ã€‚ã€‚</del></p>
<h2 id="Posterior-predictive-sample"><a href="#Posterior-predictive-sample" class="headerlink" title="Posterior predictive sample"></a>Posterior predictive sample</h2><h3 id="Brief-eg"><a href="#Brief-eg" class="headerlink" title="Brief eg."></a>Brief eg.</h3><p>ä¸¾ä¾‹ä»£ç ï¼š</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">set.seed<span class="punctuation">(</span><span class="number">123</span><span class="punctuation">)</span></span><br><span class="line">n <span class="operator">&lt;-</span> 100</span><br><span class="line">x.i <span class="operator">&lt;-</span> 1<span class="operator">:</span>n</span><br><span class="line">year.i <span class="operator">&lt;-</span> seq<span class="punctuation">(</span><span class="number">1990</span><span class="punctuation">,</span> <span class="number">1990</span> <span class="operator">+</span> n <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">y.i <span class="operator">&lt;-</span> x.i <span class="operator">+</span> rbeta<span class="punctuation">(</span>n<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="number">3</span> <span class="comment"># è¿™ä¸ªæŒ‰ç†è¯´æ˜¯æœªçŸ¥çš„ï¼Œåªç»™å‡ºy.i</span></span><br><span class="line"></span><br><span class="line">data.full <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>x <span class="operator">=</span> x.i<span class="punctuation">,</span> year <span class="operator">=</span> year.i<span class="punctuation">,</span> y <span class="operator">=</span> y.i<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹†åˆ† training å’Œ full dataset</span></span><br><span class="line">train.cut <span class="operator">&lt;-</span> quantile<span class="punctuation">(</span>data.full<span class="operator">$</span>year<span class="punctuation">,</span> <span class="number">0.8</span><span class="punctuation">)</span> <span class="comment"># 80% training</span></span><br><span class="line">data.train <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>data.full<span class="punctuation">,</span> year <span class="operator">&lt;=</span> train.cut<span class="punctuation">)</span>  <span class="comment"># training set</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œç”¨çš„jagså»ºæ¨¡ï¼ˆæ¨¡å‹éšæ„ï¼‰ï¼Œç„¶å<code>parameters.to.save = c("beta0", "beta1")</code>å¾—åˆ°åéªŒæŠ½æ ·ï¼š</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b0.train <span class="operator">&lt;-</span> fit.train<span class="operator">$</span>BUGSoutput<span class="operator">$</span>sims.list<span class="operator">$</span>beta0</span><br><span class="line">b1.train <span class="operator">&lt;-</span> fit.train<span class="operator">$</span>BUGSoutput<span class="operator">$</span>sims.list<span class="operator">$</span>beta1</span><br><span class="line">sigma_train <span class="operator">&lt;-</span> fit_train<span class="operator">$</span>BUGSoutput<span class="operator">$</span>sims.list<span class="operator">$</span>sigma</span><br></pre></td></tr></table></figure>
<h3 id="Posterior-predict"><a href="#Posterior-predict" class="headerlink" title="Posterior predict"></a>Posterior predict</h3><p>åé¢å°±æ˜¯å¯¹åº”testing dataé‡Œé¢çš„æ¯ä¸€æ¡æ•°æ®ï¼Œæ‰¾åˆ°å¯¹åº”yearå€¼åŒ¹é…ï¼Œå¾—åˆ°ä¸€ä¸ªmatrix: row = length(testing data), col = predicted sample.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>yr <span class="keyword">in</span> data.valid.years<span class="punctuation">)</span> <span class="punctuation">{</span></span><br><span class="line">  row <span class="operator">&lt;-</span> data.full<span class="punctuation">[</span>data.full<span class="operator">$</span>year <span class="operator">==</span> yr<span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">  x_val <span class="operator">&lt;-</span> row<span class="operator">$</span>x</span><br><span class="line">  y_obs <span class="operator">&lt;-</span> row<span class="operator">$</span>y</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Training æ¨¡å‹é¢„æµ‹</span></span><br><span class="line">  mu_draws  <span class="operator">&lt;-</span> b0.train <span class="operator">+</span> b1.train <span class="operator">*</span> x_val</span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></table></figure>
<p>é‡ç‚¹æ¥äº†ï¼Œ<strong>pred.train</strong>åœ¨è¿™é‡Œæ˜¯<strong>æœŸæœ›å€¼</strong>(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.489ex;" xmlns="http://www.w3.org/2000/svg" width="1.364ex" height="1.489ex" role="img" focusable="false" viewbox="0 -442 603 658"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D707" d="M58 -216Q44 -216 34 -208T23 -186Q23 -176 96 116T173 414Q186 442 219 442Q231 441 239 435T249 423T251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26Q261 26 270 27T287 31T302 38T315 45T327 55T338 65T348 77T356 88T365 100L372 110L408 253Q444 395 448 404Q461 431 491 431Q504 431 512 424T523 412T525 402L449 84Q448 79 448 68Q448 43 455 35T476 26Q485 27 496 35Q517 55 537 131Q543 151 547 152Q549 153 557 153H561Q580 153 580 144Q580 138 575 117T555 63T523 13Q510 0 491 -8Q483 -10 467 -10Q446 -10 429 -4T402 11T385 29T376 44T374 51L368 45Q362 39 350 30T324 12T288 -4T246 -11Q199 -11 153 12L129 -85Q108 -167 104 -180T92 -202Q76 -216 58 -216Z"/></g></g></g></svg></mjx-container>)ï¼Œä¹Ÿå°±æ˜¯latent meanï¼Œä¸æ˜¯æ¦‚ç‡å¯†åº¦(posterior predictive density).<br>å¦‚æœè¦å¾—åˆ°åéªŒæ¦‚ç‡likelihoodï¼š</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŠŠé¢„æµ‹å€¼å½“ä½œåˆ†å¸ƒçš„å‚æ•°ï¼Œå»è®¡ç®—æŸä¸ªè§‚æµ‹å€¼åœ¨è¯¥åˆ†å¸ƒä¸‹çš„å¯†åº¦æˆ–è€…æ¦‚ç‡</span></span><br><span class="line">yrep <span class="operator">&lt;-</span> rnorm<span class="punctuation">(</span>draw_length<span class="punctuation">,</span> mean <span class="operator">=</span> mu_draws <span class="punctuation">,</span> sd <span class="operator">=</span> sigma_train<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>ä¸Šé¢æåˆ°äº†1ï¼‰é¢„æµ‹çš„<strong>å‡å€¼</strong>ï¼Œæ˜¯sampleé‡Œé¢æ¯ä¸€æ¡æ•°æ®çš„æ ·æœ¬å‡å€¼ï¼Œç”¨æ¥è·å¾—posterior sampleçš„å‡å€¼é¢„æµ‹åŒºé—´ç­‰ã€‚2ï¼‰åˆ†å¸ƒ<strong>æ¦‚ç‡</strong>ï¼Œåš WAICã€LOO-CVã€é¢„æµ‹éªŒè¯ï¼Œéœ€è¦ç»“åˆ posterior ä¼°è®¡çš„ <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.029ex;" xmlns="http://www.w3.org/2000/svg" width="1.17ex" height="1.005ex" role="img" focusable="false" viewbox="0 -431 517 444"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D70F" d="M39 284Q18 284 18 294Q18 301 45 338T99 398Q134 425 164 429Q170 431 332 431Q492 431 497 429Q517 424 517 402Q517 388 508 376T485 360Q479 358 389 358T299 356Q298 355 283 274T251 109T233 20Q228 5 215 -4T186 -13Q153 -13 153 20V30L203 192Q214 228 227 272T248 336L254 357Q254 358 208 358Q206 358 197 358T183 359Q105 359 61 295Q56 287 53 286T39 284Z"/></g></g></g></svg></mjx-container>ï¼ˆç²¾åº¦ï¼‰æˆ–<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.292ex" height="1ex" role="img" focusable="false" viewbox="0 -431 571 442"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"/></g></g></g></svg></mjx-container>ï¼ˆæ ‡å‡†å·®ï¼‰æ¥è®¡ç®—ã€‚<br>æ¯”å¦‚è¿™é‡Œï¼Œå¦‚æœè¦å’Œtesting data (observationçœŸå®æ•°æ®)å¯¹æ¯”ï¼Œä¹Ÿå°±æ˜¯é¢„æµ‹éªŒè¯ï¼Œæ‰€ä»¥è¦è€ƒè™‘observationçš„å™ªå£°(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.029ex;" xmlns="http://www.w3.org/2000/svg" width="1.17ex" height="1.005ex" role="img" focusable="false" viewbox="0 -431 517 444"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D70F" d="M39 284Q18 284 18 294Q18 301 45 338T99 398Q134 425 164 429Q170 431 332 431Q492 431 497 429Q517 424 517 402Q517 388 508 376T485 360Q479 358 389 358T299 356Q298 355 283 274T251 109T233 20Q228 5 215 -4T186 -13Q153 -13 153 20V30L203 192Q214 228 227 272T248 336L254 357Q254 358 208 358Q206 358 197 358T183 359Q105 359 61 295Q56 287 53 286T39 284Z"/></g></g></g></svg></mjx-container>).</p>
<h2 id="Validation"><a href="#Validation" class="headerlink" title="Validation"></a>Validation</h2><p>è¿™é‡Œå°±æ˜¯çœ‹predicted sampleåœ¨testing dataçš„é¢„æµ‹æƒ…å†µï¼Œè€ƒè™‘ä¸‹é¢ä¸¤ä¸ªæŒ‡æ ‡ï¼š</p>
<ul>
<li>Median/mean value</li>
<li>95% PI</li>
</ul>
<h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><p>è¿™é‡ŒåŒ…æ‹¬Mean error å’Œ Absolute mean error.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mean error</span></span><br><span class="line">pred_mean<span class="punctuation">[</span>j<span class="punctuation">]</span>  <span class="operator">&lt;-</span> mean<span class="punctuation">(</span>yrep<span class="punctuation">)</span></span><br><span class="line">residuals<span class="punctuation">[</span>j<span class="punctuation">]</span>  <span class="operator">&lt;-</span> test<span class="operator">$</span>y<span class="punctuation">[</span>j<span class="punctuation">]</span> <span class="operator">-</span> pred_mean<span class="punctuation">[</span>j<span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># abs mean error</span></span><br><span class="line">mae <span class="operator">&lt;-</span> mean<span class="punctuation">(</span><span class="built_in">abs</span><span class="punctuation">(</span>residuals<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h3 id="Coverage"><a href="#Coverage" class="headerlink" title="Coverage"></a>Coverage</h3><p>å¦‚æœé€‰æ‹©95%PIï¼Œé‚£ä¹ˆcoverageçš„æœŸæœ›å€¼å°±æ˜¯95%ï¼ˆbelowä¸‹é™å’Œaboveä¸Šé™çš„éƒ½æ˜¯5%ï¼‰ã€‚</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pred_lower<span class="punctuation">[</span>j<span class="punctuation">]</span> <span class="operator">&lt;-</span> quantile<span class="punctuation">(</span>yrep<span class="punctuation">,</span> <span class="number">0.025</span><span class="punctuation">)</span></span><br><span class="line">pred_upper<span class="punctuation">[</span>j<span class="punctuation">]</span> <span class="operator">&lt;-</span> quantile<span class="punctuation">(</span>yrep<span class="punctuation">,</span> <span class="number">0.975</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">coverage95 <span class="operator">&lt;-</span> mean<span class="punctuation">(</span>test<span class="operator">$</span>y <span class="operator">&gt;=</span> pred_lower <span class="operator">&amp;</span> test<span class="operator">$</span>y <span class="operator">&lt;=</span> pred_upper<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h2 id="End"><a href="#End" class="headerlink" title="End"></a>End</h2><p>å¦‚æœè¦çœ‹training dataå’Œfull dataè®­ç»ƒçš„æ¨¡å‹å·®å¼‚ï¼Œå°±ç”¨full data fitç›¸åŒçš„æ¨¡å‹ï¼Œç„¶åç”¨predicted valueå¯¹æ¯”ï¼ˆä¸éœ€è¦obs errorï¼‰ã€‚ä½¿ç”¨åŒæ ·æŒ‡æ ‡ã€‚</p>
<p>åœ¨validationè¿‡ç¨‹ä¸­ï¼Œå¦‚æœé¢„æµ‹ä¸è¾¾é¢„æœŸï¼ˆerrorè¿‡å¤§æˆ–coverageè¦†ç›–å¤ªå°‘ï¼‰ï¼Œé¦–å…ˆè€ƒè™‘æ¨¡å‹ï¼Œerrorè¿‡å¤§å°±æ˜¯æ¨¡å‹é€‰æ‹©é—®é¢˜äº†ï¼Œå¯ä»¥è€ƒè™‘å˜é‡ç›¸å…³ï¼ˆæ¯”å¦‚æ§åˆ¶å˜é‡ï¼‰ï¼›å¦‚æœerrorå¾ˆå¥½ä½†æ˜¯coverageå¤ªå°ï¼ˆä½äº60%è¿™æ ·ï¼‰ï¼Œå°±è¦çœ‹çœ‹æœ‰æ²¡æœ‰è€ƒè™‘observation errorï¼åœ¨è¿™ä¹‹å‰ï¼Œå¯ä»¥å…ˆç”»ä¸€ä¸ªPITå›¾ï¼Œå¦‚æœæ˜¯Uå‹ï¼Œé‚£å°±æ˜¯è§‚æµ‹è¯¯å·®çš„é—®é¢˜ã€‚ <code>fit_train$BUGSoutput$sims.list$sigma</code>åœ¨å–åéªŒæ ·æœ¬åŠ ä¸Šè¿™ä¸ªä¸œè¥¿ã€‚</p>
<p>å…³äºpesterior predictive sampleçš„ç”Ÿæˆï¼Œ<code>dnorm</code> or <code>rnorm</code> è¿™ä¸ªé—®é¢˜è¯¢é—®çš„æ˜¯Gè€å¸ˆï¼Œç»™å‡ºçš„å›ç­”ï¼š</p>
<blockquote>
<p><strong>rnorm</strong>: åéªŒé¢„æµ‹åˆ†å¸ƒ, ç›´æ¥åœ°å¾—åˆ°ä½ è¦çš„éªŒè¯æŒ‡æ ‡<br><strong>dnorm</strong>: åŸºäºå¯†åº¦çš„è¯„åˆ†è§„åˆ™ï¼ˆæ¯”å¦‚ log predictive densityã€elpdï¼‰ï¼Œ<br>é‚£æ—¶å†ç”¨ dnorm(y_obs, mean=mu_draw, sd=sigma_draw) æ±‚å¯†åº¦å¹¶å–å¯¹æ•°ã€å¯¹æ ·æœ¬æ±‚å¹³å‡å°±è¡Œ</p>
</blockquote>
<p>å—¯ï¼Œå°±æ˜¯<strong>å¯†åº¦</strong>å‡½æ•°å’Œéšæœºç”Ÿæˆå‡½æ•°çš„åŒºåˆ«ã€‚å…·ä½“çš„è®²è§£<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a24eb1b94177">è¿™é‡Œ</a>è®²çš„æŒºæ¸…æ¥šçš„ã€‚</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol>
<li>Vehtari, A., Gelman, A., and Gabry, J. (2017). Practical bayesian model evaluation using leave-one-out cross-validation and waic Statistics and computing, 27(5):1413â€“1432.</li>
<li>Rè¯­è¨€ä¸­dnorm, pnorm, qnormä¸rnormä»¥åŠéšæœºæ•°ã€‚<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a24eb1b94177">source</a></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Bayesian-model-method/" rel="tag"># Bayesian model, method</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/07/24/inla-install/" rel="prev" title="inla_install">
                  <i class="fa fa-angle-left"></i> inla_install
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/10/15/bhm-1/" rel="next" title="Bayesian Hierarchical Model 1">
                  Bayesian Hierarchical Model 1 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Nobody</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
